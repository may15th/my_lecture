<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
   
<body>
  <button>냥냥펀치</button>
  
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    const URL =  "https://api.thecatapi.com/v1/images/search"
    // 버튼을 누르면 - 버튼을 선택 요소로 설정해줌.
    const btn = document.querySelector('button')
    // 버튼 클릭 이벤트 발생했을 때 axios실행해 줌.
    // getCats라는 함수 만들어두고 그 안에 axios 넣어.
    const getCats = function () {
      axios({
        method: 'get',
        url: URL,
      })
      
    // 응답 받은 결과에서 url을 찾고
    // img태그를 만들고
    // img속성을 채우고
    // body에 img속성을 추가한다.
       .then((response)=>{
          // console.log(response)
          // console.log(response.data)
          // console.log(response.data[0].url)
          const imgUrl = response.data[0].url
          return imgUrl
       })
       // 이런식으로 .then을 나눠서 하기 쉬워
       // 두번째 .then은 앞이 return이 이써ㅇ야 해..

       .then((imgUrl) => {
        const imgTag = document.createElement('img')
          // 이미지 태그 속성을 src라는 속성값 세팅하고,
          // axios응답을 통해 받은 imgurl을 이미지 속성값으로 넣어줘.
          imgTag.setAttribute('src', imgUrl)
          //append child해줘야해. body에 어펜드 차일드 해주는 거라는데..
          document.body.appendChild(imgTag)
       })
       .catch((error) => {
        console.log(error)
       })
    }

    btn.addEventListener('click', getCats)
    // axios는 브라우저에서 비동기로 데이터 통신 가능하게 하는 라이브러리
    // 같은 방식으로 drf로 만든 api서버로 요청을 보내서
    // 데이터를 받아온 후 처리할 수 있도록 함.
    // drf 서버는 문서를 주지 않음.
    // 요청과 응답에서 페이지의 일부분만 수정할 수 있게됨.
    // 고양이 이미지만 계속해서 추가되듯이.

    // 비동기 처리의 단점
    // 비동기 처리의 핵심은 작업 완료되는 순서에 따라 처리한다는 것.
    // 코드의 실행 순서가 불명확하다는 단점 존재
    // time 설정 3초 준것도 정확히 3초 뒤 불명확해

    // 비동기 콜백
    // 비동기적으로 처리되는 작업이 완료되었을 때 실행되는 함수.
    // 비동기 콜백 순서 주는 법 - 콜백함수가 콜백을 실행하면 됨.

    // 비동기 콜백의 단점 = 콜백지옥
    // 비동기 처리를 위해 콜백을 작성할 때 마주하는 문제.

    // promise - 비동기 작업의 결과를 나타내는 객체
    // 비동기 작업이 완료되었을 때 결과값을 반환하거나, 실패시 에러를 처리하는 기능 제공.

    // .then을 chaining해서 이어간다
    // axios가 promise based어쩌고 라서 .then chaining구조 하는 것.

    // .then 메서드 chaining의 목적은
    //  코드를 직과적 가독성 있게 작성.




  </script>
</body>

</html>
